AUI.add("aui-carousel",function(r){var e=r.Lang,q=" ",l="carousel",E=r.getClassName,n=E(l,"item"),d=E(l,"item","active"),D=E(l,"item","transition"),b=E(l,"menu","active"),v=E(l,"menu","index"),k=E(l,"menu","item"),c=E(l,"menu","next"),j=E(l,"menu","play"),t=E(l,"menu","pause"),a=E(l,"menu","prev"),y=[k,v].join(q),h=[k,v,b].join(q),u=".",s=75,g=0.5,i=u+v,p=u+c,f=u+t,x=u+j,z=[x,f].join(),o=u+a,m=new r.Template("<menu>",'<li><a class="',k," ",j,'"></a></li>','<li><a class="',k," ",a,'"></a></li>','<tpl for="items">','<li><a class="',k,' {[ $i == parent.activeIndex ? "',h,'" : "',y,'" ]}">{$index}</a></li>',"</tpl>",'<li><a class="',k," ",c,'"></a></li>',"</menu>"),C=r.Widget.UI_SRC,B={src:C};var w=r.Component.create({NAME:l,ATTRS:{activeIndex:{value:0,setter:"_setActiveIndex"},animationTime:{value:0.5},intervalTime:{value:0.75},itemSelector:{value:">*"},nodeMenu:{value:null,setter:"_setNodeMenu"},nodeMenuItemSelector:{value:u+k},playing:{value:true}},prototype:{animation:null,nodeSelection:null,nodeMenu:null,initializer:function(){var A=this;A.animation=new r.Anim({duration:A.get("animationTime"),to:{opacity:1}});},renderUI:function(){var A=this;A._updateNodeSelection();A.nodeMenu=A.get("nodeMenu");A._updateMenuNodes();},bindUI:function(){var A=this;A.after({activeIndexChange:A._afterActiveIndexChange,animationTimeChange:A._afterAnimationTimeChange,itemSelectorChange:A._afterItemSelectorChange,intervalTimeChange:A._afterIntervalTimeChange,nodeMenuItemSelector:A._afterNodeMenuItemSelectorChange,playingChange:A._afterPlayingChange});A._bindMenu();A._bindItemGestures();if(A.get("playing")===true){A._afterPlayingChange({prevVal:false,newVal:true});}},syncUI:function(){var A=this;A._uiSetActiveIndex(A.get("activeIndex"));},item:function(F){var A=this;A.set("activeIndex",F);},next:function(){var A=this;A._updateIndexNext();},pause:function(){var A=this;A.set("playing",false);},play:function(){var A=this;A.set("playing",true);},prev:function(){var A=this;A._updateIndexPrev();},_afterActiveIndexChange:function(F){var A=this;A._uiSetActiveIndex(F.newVal,{prevVal:F.prevVal,animate:A.get("playing"),src:F.src});},_afterAnimationTimeChange:function(F){var A=this;A.animation.set("duration",F.newVal);},_afterItemSelectorChange:function(F){var A=this;A._updateNodeSelection();},_afterNodeMenuItemSelectorChange:function(F){var A=this;A.nodeMenuItemSelector=F.newVal;A._updateMenuNodes();},_afterIntervalTimeChange:function(F){var A=this;A._clearIntervalRotationTask();A._createIntervalRotationTask();},_afterPlayingChange:function(H){var A=this;var K=A.nodeMenu.one(z);var G=H.newVal;var J=t;var F=j;var I="_clearIntervalRotationTask";if(G){J=j;F=t;I="_createIntervalRotationTask";}A[I]();if(K){K.replaceClass(J,F);}},_bindMenu:function(){var A=this;var F=A.nodeMenu;var G=A.get("nodeMenuItemSelector");F.delegate("click",A._onClickDelegate,G,A);A.nodeMenuItemSelector=G;},_bindItemGestures:function(){var A=this;var F=A.get("contentBox");var H=F.all(u+n);var G={minDistance:s,minVelocity:g};H.each(function(J,I,K){J.on("flick",A._onFlickHandler,G,A);});},_clearIntervalRotationTask:function(){var A=this;clearInterval(A._intervalRotationTask);},_createIndexRandom:function(){var A=this;return Math.ceil(Math.random()*A.nodeSelection.size())-1;},_createIntervalRotationTask:function(){var A=this;A._clearIntervalRotationTask();A._intervalRotationTask=setInterval(function(){A._updateIndexNext({animate:true});},A.get("intervalTime")*1000);},_onAnimationEnd:function(H,I,G,F,J){var A=this;if(G){G.removeClass(D);}I.setStyle("opacity","1");},_onAnimationStart:function(H,I,G,F,J){var A=this;I.addClass(d);if(F){F.addClass(b);}if(G){G.replaceClass(d,D);}if(J){J.removeClass(b);}},_onClickDelegate:function(G){var A=this;G.preventDefault();var H=G.currentTarget;var F;if(H.hasClass(v)){F=A._onMenuItemClick;}else{if(H.hasClass(a)){F=A._updateIndexPrev;}else{if(H.hasClass(c)){F=A._updateIndexNext;}else{if(H.test(z)){F=A._onMenuPlayClick;}}}}if(F){F.apply(A,arguments);}},_onFlickHandler:function(G){var A=this;var F;var H=G.flick.distance;if(G.flick.axis=="x"){if(H<0){F=A._updateIndexNext;}else{if(H>0){F=A._updateIndexPrev;}}if(F){F.apply(A,arguments);}}},_onMenuItemClick:function(G){var A=this;G.preventDefault();var F=A.menuNodes.indexOf(G.currentTarget);A.set("activeIndex",F,B);},_onMenuPlayClick:function(F){var A=this;this.set("playing",!this.get("playing"));},_renderMenu:function(){var A=this;var F=m.render({items:A.nodeSelection.getDOM(),activeIndex:A.get("activeIndex")});A.get("contentBox").appendChild(F);return F;},_setActiveIndex:function(F){var A=this;if(F=="rand"){F=A._createIndexRandom();}else{F=Math.max(Math.min(F,A.nodeSelection.size()),-1);}return F;},_setNodeMenu:function(F){var A=this;return r.one(F)||A._renderMenu();},_uiSetActiveIndex:function(G,L){var N=this;var K=null;var I=null;var O=null;var A=null;var M=N.nodeSelection.item(G);var J=N.menuNodes;var F=J.item(G);N.animation.set("node",M);if(L&&!e.isUndefined(L.prevVal)){var H=L.prevVal;M.setStyle("opacity","0");I=J.item(H);K=N.nodeSelection.item(H);K.replaceClass(d,D);N.animation.stop();}else{M.addClass(d);M.setStyle("opacity","1");}O=N.animation.on("start",function(P){N._onAnimationStart(P,M,K,F,I);O.detach();});A=N.animation.on("end",function(P){N._onAnimationEnd(P,M,K,F,I);A.detach();});if(L){if(L.animate){N.animation.run();}else{N.animation.fire("start");N.animation.fire("end");}if(L.src==C&&L.animate){N._createIntervalRotationTask();}}},_updateIndexNext:function(G){var A=this;var F=A.get("activeIndex");var I=A.nodeSelection.size();var H=F+1;if(H>(I-1)){H=0;}if(G){G.src=C;}A.set("activeIndex",H,G);},_updateIndexPrev:function(G){var A=this;var F=A.get("activeIndex");var H=F-1;if(H<0){H=A.nodeSelection.size()-1;}if(G){G.src=C;}A.set("activeIndex",H,G);},_updateMenuNodes:function(){var A=this;A.menuNodes=A.nodeMenu.all(i);},_updateNodeSelection:function(){var A=this;var F=A.get("itemSelector");var G=A.get("contentBox").all(F);G.addClass(n);A.nodeSelection=G;},_intervalRotationTask:null}});
r.Carousel=w;},"@VERSION@",{requires:["aui-base","aui-template","anim"],skinnable:true});