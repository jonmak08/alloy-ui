AUI.add("aui-editor-creole-parser",function(a){if(!b){var b={};}if(!b.Simple){b.Simple={};}b.Simple.Base=function(c,d){if(!arguments.length){return;}this.grammar=c;this.grammar.root=new this.ruleConstructor(this.grammar.root);this.options=d;};b.Simple.Base.prototype={ruleConstructor:null,grammar:null,options:null,parse:function(d,e,c){if(c){for(i in this.options){if(typeof c[i]=="undefined"){c[i]=this.options[i];}}}else{c=this.options;}e=e.replace(/\r\n?/g,"\n");this.grammar.root.apply(d,e,c);if(c&&c.forIE){d.innerHTML=d.innerHTML.replace(/\r?\n/g,"\r\n");}}};b.Simple.Base.prototype.constructor=b.Simple.Base;b.Simple.Base.Rule=function(d){if(!arguments.length){return;}for(var c in d){this[c]=d[c];}if(!this.children){this.children=[];}};b.Simple.Base.prototype.ruleConstructor=b.Simple.Base.Rule;b.Simple.Base.Rule.prototype={regex:null,capture:null,replaceRegex:null,replaceString:null,tag:null,attrs:null,children:null,match:function(d,c){return d.match(this.regex);},build:function(f,e,c){var g;if(this.capture!==null){g=e[this.capture];}var h;if(this.tag){h=document.createElement(this.tag);f.appendChild(h);}else{h=f;}if(g){if(this.replaceRegex){g=g.replace(this.replaceRegex,this.replaceString);}this.apply(h,g,c);}if(this.attrs){for(var d in this.attrs){h.setAttribute(d,this.attrs[d]);if(c&&c.forIE&&d=="class"){h.className=this.attrs[d];}}}return this;},apply:function(c,e,m){var h=""+e;var g=[];if(!this.fallback.apply){this.fallback=new this.constructor(this.fallback);}while(true){var d=false;var l=false;for(var f=0;f<this.children.length;f++){if(typeof g[f]=="undefined"){if(!this.children[f].match){this.children[f]=new this.constructor(this.children[f]);}g[f]=this.children[f].match(h,m);}if(g[f]&&(!d||d.index>g[f].index)){d=g[f];l=this.children[f];if(d.index==0){break;}}}var k=d?d.index:h.length;if(k>0){this.fallback.apply(c,h.substring(0,k),m);}if(!d){break;}if(!l.build){l=new this.constructor(l);}l.build(c,d,m);var j=d.index+d[0].length;h=h.substring(j);for(var f=0;f<this.children.length;f++){if(g[f]){if(g[f].index>=j){g[f].index-=j;}else{g[f]=void 0;}}}}return this;},fallback:{apply:function(d,e,c){if(c&&c.forIE){e=e.replace(/\n/g," \r");}d.appendChild(document.createTextNode(e));}}};b.Simple.Base.Rule.prototype.constructor=b.Simple.Base.Rule;b.Simple.Creole=function(c){var h={};h.link="[^\\]|~\\n]*(?:(?:\\](?!\\])|~.)[^\\]|~\\n]*)*";h.linkText="[^\\]~\\n]*(?:(?:\\](?!\\])|~.)[^\\]~\\n]*)*";h.uriPrefix="\\b(?:(?:https?|ftp)://|mailto:)";h.uri=h.uriPrefix+h.link;h.rawUri=h.uriPrefix+"\\S*[^\\s!\"',.:;?]";h.interwikiPrefix="[\\w.]+:";h.interwikiLink=h.interwikiPrefix+h.link;h.img="\\{\\{((?!\\{)[^|}\\n]*(?:}(?!})[^|}\\n]*)*)"+(c&&c.strict?"":"(?:")+"\\|([^}~\\n]*((}(?!})|~.)[^}~\\n]*)*)"+(c&&c.strict?"":")?")+"}}";var f=function(g,j){if(j instanceof Function){return j(g);}j=j instanceof Array?j:[j];if(typeof j[1]=="undefined"){j[1]="";}return j[0]+g+j[1];};var e={hr:{tag:"hr",regex:/(^|\n)\s*----\s*(\n|$)/},br:{tag:"br",regex:/\\\\/},preBlock:{tag:"pre",capture:2,regex:/(^|\n)\{\{\{\n((.*\n)*?)\}\}\}(\n|$)/,replaceRegex:/^ ([ \t]*\}\}\})/gm,replaceString:"$1"},tt:{tag:"tt",regex:/\{\{\{(.*?\}\}\}+)/,capture:1,replaceRegex:/\}\}\}$/,replaceString:""},ulist:{tag:"ul",capture:0,regex:/(^|\n)([ \t]*\*[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},olist:{tag:"ol",capture:0,regex:/(^|\n)([ \t]*#[^*#].*(\n|$)([ \t]*[^\s*#].*(\n|$))*([ \t]*[*#]{2}.*(\n|$))*)+/},li:{tag:"li",capture:0,regex:/[ \t]*([*#]).+(\n[ \t]*[^*#\s].*)*(\n[ \t]*\1[*#].+)*/,replaceRegex:/(^|\n)[ \t]*[*#]/g,replaceString:"$1"},table:{tag:"table",capture:0,regex:/(^|\n)(\|.*?[ \t]*(\n|$))+/},tr:{tag:"tr",capture:2,regex:/(^|\n)(\|.*?)\|?[ \t]*(\n|$)/},th:{tag:"th",regex:/\|+=([^|]*)/,capture:1},td:{tag:"td",capture:1,regex:"\\|+([^|~\\[{]*((~(.|(?=\\n)|$)|"+"\\[\\["+h.link+"(\\|"+h.linkText+")?\\]\\]"+(c&&c.strict?"":"|"+h.img)+"|[\\[{])[^|~]*)*)"},singleLine:{regex:/.+/,capture:0},paragraph:{tag:"p",capture:0,regex:/(^|\n)([ \t]*\S.*(\n|$))+/},text:{capture:0,regex:/(^|\n)([ \t]*[^\s].*(\n|$))+/},strong:{tag:"strong",capture:1,regex:/\*\*([^*~]*((\*(?!\*)|~(.|(?=\n)|$))[^*~]*)*)(\*\*|\n|$)/},em:{tag:"em",capture:1,regex:"\\/\\/(((?!"+h.uriPrefix+")[^\\/~])*"+"(("+h.rawUri+"|\\/(?!\\/)|~(.|(?=\\n)|$))"+"((?!"+h.uriPrefix+")[^\\/~])*)*)(\\/\\/|\\n|$)"},img:{regex:h.img,build:function(l,k,j){var g=document.createElement("img");g.src=k[1];g.alt=k[2]===undefined?(j&&j.defaultImageText?j.defaultImageText:""):k[2].replace(/~(.)/g,"$1");l.appendChild(g);}},namedUri:{regex:"\\[\\[("+h.uri+")\\|("+h.linkText+")\\]\\]",build:function(l,k,g){var j=document.createElement("a");j.href=k[1];if(g&&g.isPlainUri){j.appendChild(document.createTextNode(k[2]));}else{this.apply(j,k[2],g);}l.appendChild(j);}},namedLink:{regex:"\\[\\[("+h.link+")\\|("+h.linkText+")\\]\\]",build:function(l,k,g){var j=document.createElement("a");j.href=g&&g.linkFormat?f(k[1].replace(/~(.)/g,"$1"),g.linkFormat):k[1].replace(/~(.)/g,"$1");this.apply(j,k[2],g);l.appendChild(j);}},unnamedUri:{regex:"\\[\\[("+h.uri+")\\]\\]",build:"dummy"},unnamedLink:{regex:"\\[\\[("+h.link+")\\]\\]",build:"dummy"},unnamedInterwikiLink:{regex:"\\[\\[("+h.interwikiLink+")\\]\\]",build:"dummy"},rawUri:{regex:"("+h.rawUri+")",build:"dummy"},escapedSequence:{regex:"~("+h.rawUri+"|.)",capture:1,tag:"span",attrs:{"class":"escaped"}},escapedSymbol:{regex:/~(.)/,capture:1,tag:"span",attrs:{"class":"escaped"}}};e.unnamedUri.build=e.rawUri.build=function(k,j,g){if(!g){g={};}g.isPlainUri=true;e.namedUri.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.unnamedLink.build=function(k,j,g){e.namedLink.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.namedInterwikiLink={regex:"\\[\\[("+h.interwikiLink+")\\|("+h.linkText+")\\]\\]",build:function(n,l,j){var k=document.createElement("a");var g,o;if(j&&j.interwiki){g=l[1].match(/(.*?):(.*)/);o=j.interwiki[g[1]];}if(typeof o=="undefined"){if(!e.namedLink.apply){e.namedLink=new this.constructor(e.namedLink);}return e.namedLink.build.call(e.namedLink,n,l,j);
}k.href=f(g[2].replace(/~(.)/g,"$1"),o);this.apply(k,l[2],j);n.appendChild(k);}};e.unnamedInterwikiLink.build=function(k,j,g){e.namedInterwikiLink.build.call(this,k,Array(j[0],j[1],j[1]),g);};e.namedUri.children=e.unnamedUri.children=e.rawUri.children=e.namedLink.children=e.unnamedLink.children=e.namedInterwikiLink.children=e.unnamedInterwikiLink.children=[e.escapedSymbol,e.img];for(var d=1;d<=6;d++){e["h"+d]={tag:"h"+d,capture:2,regex:"(^|\\n)[ \\t]*={"+d+"}[ \\t]"+"([^~]*?(~(.|(?=\\n)|$))*)[ \\t]*=*\\s*(\\n|$)"};}e.ulist.children=e.olist.children=[e.li];e.li.children=[e.ulist,e.olist];e.li.fallback=e.text;e.table.children=[e.tr];e.tr.children=[e.th,e.td];e.td.children=[e.singleLine];e.th.children=[e.singleLine];e.h1.children=e.h2.children=e.h3.children=e.h4.children=e.h5.children=e.h6.children=e.singleLine.children=e.paragraph.children=e.text.children=e.strong.children=e.em.children=[e.escapedSequence,e.strong,e.em,e.br,e.rawUri,e.namedUri,e.namedInterwikiLink,e.namedLink,e.unnamedUri,e.unnamedInterwikiLink,e.unnamedLink,e.tt,e.img];e.root={children:[e.h1,e.h2,e.h3,e.h4,e.h5,e.h6,e.hr,e.ulist,e.olist,e.preBlock,e.table],fallback:{children:[e.paragraph]}};b.Simple.Base.call(this,e,c);};b.Simple.Creole.prototype=new b.Simple.Base();b.Simple.Creole.prototype.constructor=b.Simple.Creole;a.CreoleParser=b.Simple.Creole;},"@VERSION@",{requires:["aui-base"]});