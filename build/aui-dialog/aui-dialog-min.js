AUI.add("aui-dialog",function(p){var ai=p.Lang,v=p.Object,L=ai.isBoolean,C=ai.isArray,Q=ai.isObject,j=ai.toInt,E=p.WidgetStdMod,N=p.config.doc,u="",aa="boundingBox",ad="button",c="buttons",H="Change",W="clickoutside",ab="close",R="closethick",M="constrain2view",Z="data-tabindex",d="dd",T="default",ac="destroyOnClose",x="dialog",y=".",D="dragConfig",ae=5,l="dragInstance",n="draggable",U="focusoutside",g="footerContent",V="hd",K="height",I="icon",b="icons",s="io",w="loading",B="modal",ag="proxy",e="resizable",G="resizableConfig",m="resizableInstance",F="stack",S="tabIndex",i="useARIA",P="viewportRegion",af="visible",f="width",ah="zIndex",q="resize:resize",O="resize:end",h=p.getClassName,z=h(x),a=h(x,V),t=h(I,w),o=h(d),J=N.createTextNode("");var r=function(A){if(!p.DialogMask){p.DialogMask=new p.OverlayMask({visible:true}).render();}};p.mix(r,{NAME:x,ATTRS:{bodyContent:{value:J},buttons:{value:[],validator:C},close:{value:true},constrain2view:{setter:"_setConstrain2view",value:false,validator:L},destroyOnClose:{value:false,validator:L},draggable:{value:true},dragConfig:{setter:function(aj){var A=this;return p.merge({bubbleTargets:A,node:A.get(aa),handles:[y+a]},aj||{});},writeOnce:true,value:{},validator:Q},dragInstance:{setter:"_setDragInstance",value:null},focusOn:{valueFn:function(){return[{eventName:W},{eventName:U}];},validator:p.Lang.isArray},modal:{lazyAdd:false,validator:L,value:false},resizableConfig:{setter:function(aj){var A=this;return p.merge({bubbleTargets:A,handles:"r,br,b",minHeight:100,minWidth:200,constrain2view:true,node:A.get(aa),proxy:true,after:{end:p.bind(A._syncResizableDimentions,A),resize:p.bind(A._syncResizableDimentions,A)}},aj||{});},writeOnce:true,value:{},validator:Q},resizableInstance:{setter:"_setResizableInstance",value:null},resizable:{value:true},stack:{value:true,setter:function(A){return this._setStack(A);},validator:L},strings:{value:{close:"Close dialog"}}}});r.prototype={_uiHandlesModal:null,initializer:function(ak){var A=this;var am=A.get(b);var ao=A.get(ab);var an=A.get(c);if(an&&an.length&&!A.get(g)){A.set(g,J);}if(ao){var al=p.guid();var aj={icon:R,id:al,handler:{fn:A.close,context:A},title:A.get("strings").close};if(am){am.push(aj);}A.set(b,am);A._closeId=al;}A.publish("close",{defaultFn:A._close});A.addTarget(p.DialogManager);A.after("constrain2viewChange",A._afterConstrain2viewChange);A.after("drag:start",A._afterDragStart);A.after("draggableChange",A._afterDraggableChange);A.after("dragInstanceChange",A._afterDragInstanceChange);A.after("render",A._afterRenderer);A.after("resizableChange",A._afterResizableChange);A.after("resizableInstanceChange",A._afterResizableInstanceChange);},bindUI:function(){var A=this;if(A.get("modal")){A.after("focusOnChange",A._afterFocusOnChange());}A._bindLazyComponents();},syncUI:function(){var A=this;if(A.get(i)){A.plug(p.Plugin.Aria,{attributes:{visible:{ariaName:"hidden",format:function(aj){return !aj;}}}});}},destructor:function(){var A=this;var aj=A.get(aa);p.Event.purgeElement(aj,true);p.DialogManager.remove(A);},alignToViewport:function(ak,aj){var A=this;var al=p.getDoc().get(P);A.move([al.left+j(ak),al.top+j(aj)]);},_bindLazyComponents:function(){var A=this;var aj=A.get(aa);aj.on("mouseenter",p.bind(A._initLazyComponents,A));},_focus:function(ak){var A=this;var al=A.get(aa),aj=al.get("tabIndex");al.set("tabIndex",aj>=0?aj:0);A.focus();},close:function(){var A=this;A.fire("close");},_afterRenderer:function(aj){var A=this;A._initButtons();A.get(F);A.get(s);},_close:function(){var A=this;if(A.get(ac)){A.destroy();}else{A.hide();}},_initButtons:function(){var A=this;var ak=A.get(c);if(ak.length){var aj=new p.Toolbar({children:ak});aj._DEFAULT_CONTEXT=A;aj.render(A.footerNode);A.fire("contentUpdate");A.buttons=aj;}},_initLazyComponents:function(){var A=this;A.get(l);A.get(m);},_setDefaultARIAValues:function(){var A=this;var aj=A.icons;if(!A.get(i)){return;}A.aria.setRole("dialog",A.get(aa));if(aj){var ak=aj.item(A._closeId)||null;if(ak){A.aria.setAttribute("controls",A.get("id"),ak.get(aa));}}},_setDragInstance:function(aj){var A=this;if(A.get(n)){aj=new p.DD.Drag(A.get(D));A._updateDDConstrain2view(aj);}return aj;},_setResizableInstance:function(aj){var A=this;if(A.get(e)){aj=new p.Resize(A.get(G));}return aj;},_setStack:function(aj){var A=this;if(aj){p.DialogManager.register(A);}else{p.DialogManager.remove(A);}return aj;},_syncResizableDimentions:function(ak){var A=this;var aj=ak.type;var al=ak.info;if((aj===O)||((aj===q)&&!ak.currentTarget.get(ag))){A.set(K,al.offsetHeight);A.set(f,al.offsetWidth);}},_updateDDConstrain2view:function(aj){var A=this;aj.plug(p.Plugin.DDConstrained,{constrain2view:A.get(M)});},_afterConstrain2viewChange:function(aj){var A=this;A._updateDDConstrain2view(A.get(l));},_afterDraggableChange:function(aj){var A=this;A.set(l,null);},_afterDragInstanceChange:function(aj){var A=this;if(aj.prevVal){aj.prevVal.destroy();}},_afterDragStart:function(A){var ar=this;var an=ar.get(M);if(!an){var aq=ar.get(l);var al=aq.get("dragNode");var am=al.get("viewportRegion");var ak=al.get("region");var ap=[0,0];var aj=aq.deltaXY||ap;var ao=aq.mouseXY||ap;aq.plug(p.Plugin.DDConstrained,{constrain:{bottom:am.bottom+(ak.height-aj[1])-ae,left:am.left-aj[0]+ae,right:am.right+(ak.right-ao[0])+ae,top:am.top-aj[1]+ae}});}},_afterResizableChange:function(aj){var A=this;A.set(m,null);},_afterResizableInstanceChange:function(aj){var A=this;if(aj.prevVal){aj.prevVal.destroy();}},_attachUIHandlesModal:function(){var ao=this;var am=ao.get(aa),an=ao.get("maskNode"),ap=ao.get("focusOn"),aq=p.bind(ao._focus,ao),aj=[],ak,al,A;for(ak=0,al=ap.length;ak<al;ak++){A={};A.node=ap[ak].node;A.ev=ap[ak].eventName;A.keyCode=ap[ak].keyCode;if(!A.node&&!A.keyCode&&A.ev){aj.push(am.on(A.ev,aq));}else{if(A.node&&!A.keyCode&&A.ev){aj.push(A.node.on(A.ev,aq));}else{if(A.node&&A.keyCode&&A.ev){aj.push(A.node.on(A.ev,aq,A.keyCode));}else{Y.Log('focusOn ATTR Error: The event with name "'+A.ev+'" could not be attached.');}}}}ao._uiHandlesModal=aj;
},_afterFocusOnChange:function(aj){var A=this;A._detachUIHandlesModal();if(A.get(af)){A._attachUIHandlesModal();}},_detachUIHandlesModal:function(){var A=this;p.each(A._uiHandlesModal,function(aj){aj.detach();});A._uiHandlesModal=null;}};p.Dialog=p.Component.create({NAME:x,EXTENDS:p.Panel,AUGMENTS:[r,p.WidgetPosition,p.WidgetStack,p.WidgetPositionAlign,p.WidgetPositionConstrain]});var k=new p.OverlayManager({zIndexBase:1000});var X={};k._MODALS=X;k.after(["dialog:destroy","dialog:modalChange","dialog:render","dialog:visibleChange"],function(aj){var A=aj.target;if(A){var ak=A.get("id");if(aj.type!=="dialog:destroy"&&A.get("visible")&&A.get("modal")){X[ak]=true;p.DialogMask.show();k._blockIFrameFocus();}else{delete X[ak];if(v.isEmpty(X)){p.DialogMask.hide();k._unblockIFrameFocus();}}}});p.mix(k,{findByChild:function(A){return p.Widget.getByNode(p.one(A).ancestor(y+z,true));},closeByChild:function(A){return k.findByChild(A).close();},refreshByChild:function(aj){var A=k.findByChild(aj);if(A&&A.io){A.io.start();}},_blockIFrameFocus:function(){p.all("iframe").each(function(){if(this.ancestor(y+z)===null){if(!this.hasAttribute(Z)){this.setAttribute(Z,this.get(S));}this.set(S,-1);}});},_unblockIFrameFocus:function(){p.all("iframe").each(function(){if(this.hasAttribute(Z)){this.set(S,this.getAttribute(Z));}});}});p.DialogManager=k;},"@VERSION@",{skinnable:true,requires:["aui-panel","dd-constrain","aui-button-item","aui-overlay-manager","aui-overlay-mask","aui-io-plugin","aui-resize"]});